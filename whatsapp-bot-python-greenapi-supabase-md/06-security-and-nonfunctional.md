# אבטחה ודרישות לא פונקציונליות

## 6.1 אבטחת מפתחות וגישה

- שמירת המפתחות בקובץ `.env` או Vault מאובטח:
  - `GREEN_API_INSTANCE_ID`
  - `GREEN_API_TOKEN`
  - `SUPABASE_URL`
  - `SUPABASE_SERVICE_ROLE_KEY`
- אין חשיפת מפתחות בצד לקוח – כל הגישה לסופבייס מתבצעת מה-Backend בלבד.

## 6.2 Supabase ו-RLS

- RLS (Row Level Security) מופעל כברירת מחדל.
- הבוט משתמש ב-Service Role Key עם הרשאות רחבות, אך מאובטח בצד השרת (לא נחשף החוצה).
- במידת הצורך – ניתן להחיל מגבלות לוגיות (למשל: סינון נתונים לפי יחידה ארגונית) ברמת ה-SQL או ברמת לוגיקה בפייתון.

## 6.3 אבטחת Bot Server

- חשיפת ה-Bot Server (FastAPI/Flask) רק ל-Green API:
  - סינון IP/רשימת allowlist.
  - בדיקת חתימה/טוקן בכל בקשת Webhook.
- שימוש ב-HTTPS בלבד.

## 6.4 Audit ולוגים

- לוג מערכת לצורך Debug ו-Monitoring.
- כתיבה לטבלת `bot_queries_log` בסופבייס לכל שיחה:
  - מי שאל, מה שאל, מה הוחזר.
- אפשרות לדוחות שימוש על בסיס הלוג:
  - כמות שאילתות לפי משתמש/יום.
  - נושאים פופולריים.
  - זמני תגובה.

## 6.5 דרישות לא פונקציונליות

- זמן תגובה כולל יעד: 3–5 שניות.
- זמינות:
  - מטרה: 99% בשעות פעילות.
- סקיילביליות:
  - פריסת Bot Server כקונטיינר (Docker) עם אפשרות להרצה במספר מופעים.
  - Supabase מטפל בסקיילינג של מסד הנתונים לפי התוכנית שנבחרת.

## 6.6 ניטור

- Endpoint `GET /health` לבדיקת תקינות השירות.
- ניטור לוגים וסטטוסים (באמצעות כלי ניטור קיימים בארגון או במערכות ענן).

